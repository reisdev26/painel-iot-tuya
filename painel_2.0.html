<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta name="author" content="Welerson Reis">
<meta name="project" content="Painel IoT Monitor v2.0">
<meta charset="UTF-8">
<title>Painel de Dispositivos</title>
<style>
	body {
	  font-family: 'Segoe UI', Tahoma, sans-serif;
	  background: #f4f6f9;
	  color: #333;
	  padding: 30px;
	  text-align: center;
	}

	h1 {
	  margin-bottom: 30px;
	  font-size: 32px;
	  font-weight: 600;
	}

	.dashboard {
	  max-width: 800px;
	  margin: auto;
	}

	/* CARD PRINCIPAL */
	.main-device {
	  background: #ffffff;
	  border-radius: 25px;
	  box-shadow: 0 20px 40px rgba(0,0,0,0.08);
	  padding: 50px;
	  margin-bottom: 30px;
	  transition: 0.3s;
	}

	.main-device h2 {
	  font-size: 26px;
	  margin-bottom: 25px;
	  font-weight: 600;
	}

	.temperature-value {
	  font-size: 72px;
	  font-weight: 700;
	  margin: 10px 0;
	}

	.humidity-value {
	  font-size: 28px;
	  margin-bottom: 20px;
	}

	.status-online {
	  color: #28a745;
	  font-weight: bold;
	}

	.status-offline {
	  color: #dc3545;
	  font-weight: bold;
	}

	/* ALERTAS */
	.alert-warning {
	  background: linear-gradient(135deg, #fff3cd, #ffeeba);
	  border: 3px solid #ffc107;
	}

	.alert-critical {
	  background: linear-gradient(135deg, #f8d7da, #f5c6cb);
	  border: 3px solid #dc3545;
	}

	/* CARDS SECUND√ÅRIOS */
	.side-container {
	  display: flex;
	  justify-content: center;
	  gap: 30px;
	}

	.side-device {
	  background: #ffffff;
	  border-radius: 18px;
	  box-shadow: 0 10px 25px rgba(0,0,0,0.05);
	  padding: 25px 35px;
	  width: 260px;
	  transition: 0.3s;
	}

	.side-device h2 {
	  font-size: 18px;
	  margin-bottom: 15px;
	}

	.side-device:hover,
	.main-device:hover {
	  transform: translateY(-5px);
	}		   
	/* CLOCK */
	#clock {
	  position: fixed;
	  top: 20px;
	  right: 30px;
	  background: #ffffff;
	  padding: 10px 18px;
	  border-radius: 12px;
	  box-shadow: 0 8px 20px rgba(0,0,0,0.08);
	  font-size: 14px;
	  text-align: right;
	  line-height: 1.4;
	}

	#clock .time {
	  font-size: 18px;
	  font-weight: 600;
	}

	#clock .date {
	  font-size: 12px;
	  color: #666;
	}

</style>
</head>
<body>
<div id="clock">
  <div class="time"></div>
  <div class="date"></div>
</div>

<div class="dashboard">
  <div class="main-device" id="main-device"></div>
  <div class="side-container" id="side-devices"></div>
</div>
<script>
async function fetchData() {
  const res = await fetch(`${window.location.origin}/temperature`);
  const devices = await res.json();

  const mainContainer = document.getElementById("main-device");
  const sideContainer = document.getElementById("side-devices");
  mainContainer.innerHTML = "";
  sideContainer.innerHTML = "";

  // Separar dispositivo com T&H do resto
  const mainDevice = devices.find(d => d.temperature !== null && d.humidity !== null);
  const otherDevices = devices.filter(d => d !== mainDevice);

  // Preencher card principal
if (mainDevice) {

  let alertClass = "";
  let alertLabel = "";

  if (mainDevice.temperature >= 36) {
    alertClass = "alert-critical";
    alertLabel = "üö® CR√çTICO";
  } 
  else if (mainDevice.temperature >= 33) {
    alertClass = "alert-warning";
    alertLabel = "‚ö†Ô∏è ATEN√á√ÉO";
  }

  mainContainer.className = "main-device " + alertClass;

  mainContainer.innerHTML = `
      <h2>${mainDevice.name}</h2>

      <div class="temperature-value">
        ${mainDevice.temperature}¬∞C
      </div>

      <div class="humidity-value">
        üíß ${mainDevice.humidity}%
      </div>

      <p>${alertLabel}</p>

      <p>Status: 
        <span class="${mainDevice.online ? 'status-online' : 'status-offline'}">
          ${mainDevice.online ? 'Online' : 'Offline'}
        </span>
      </p>
  `;
}
  // Preencher os cards menores
  otherDevices.forEach(d => {
    const div = document.createElement("div");
    div.className = "side-device";

    const statusText = d.online ? "Online" : "Offline";
    const statusClass = d.online ? "status-online" : "status-offline";

    div.innerHTML = `
      <h2>${d.name}</h2>
      <p>Status: <span class="${statusClass}">${statusText}</span></p>
    `;
    sideContainer.appendChild(div);
  });
}

// Atualiza a cada 10 segundos
fetchData();
setInterval(fetchData, 10000);

// Rel√≥gio em tempo real
function updateClock() {
  const now = new Date();

  const time = now.toLocaleTimeString('pt-BR');
  const date = now.toLocaleDateString('pt-BR', {
    //weekday: 'long',
    day: '2-digit',
    month: '2-digit',
    year: 'numeric'
  });

  document.querySelector("#clock .time").textContent = time;
  document.querySelector("#clock .date").textContent = date;
}

updateClock();
setInterval(updateClock, 1000);

console.log("%cPainel IoT Monitor v2.0", "color: #007acc; font-size: 16px; font-weight: bold;");
console.log("Desenvolvido por Welerson Reis ‚Ä¢ 2026");

</script>
</body>
<!--
============================================================
Projeto: Painel IoT Monitor
Autor: Welerson Reis
Ano: 2026
Descri√ß√£o: Dashboard de monitoramento integrado com Tuya Cloud API
GitHub:**   https://github.com/reisdev26  
LinkedIn:** https://www.linkedin.com/in/welerson-reis-/  
============================================================
-->
</html>
